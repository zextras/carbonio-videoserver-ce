targets=(
  "centos"
  "ubuntu"
)
pkgname="carbonio-libev"
pkgver="4.33"
pkgrel="1"
pkgdesc="A full-featured and high-performance event loop"
pkgdesclong=(
  "A full-featured and high-performance event loop"
)
arch="amd64"
maintainer="Zextras <packages@zextras.com"
url="https://software.schmorp.de/pkg/libev.html"
license=("BSD")
depends:apt=(
  "libc6" 
)
depends:yum=(
  "glibc" 
)

section="libs"
priority="important"
sources=(
  "http://dist.schmorp.de/libev/libev-${pkgver}.tar.gz"
)
hashsums=(
  "133587b89c34dba0b3a2d2a90ba59f6748f6c368"
)

build() {
  cd "libev-${pkgver}"
  export LDFLAGS="-Wl,-rpath,/opt/zextras/common/lib"
  export PKG_CONFIG_PATH="/opt/zextras/common/lib/pkgconfig"
  ./configure --prefix=/opt/zextras/common
  make
}

package() {
  cd "libev-${pkgver}"
  make DESTDIR="${pkgdir}" install
  # fix conflict with libevent
  rm "${pkgdir}/opt/zextras/common/include/event.h"

  rm -rf "${pkgdir}"/opt/zextras/common/lib/*.a
  rm -rf "${pkgdir}"/opt/zextras/common/lib/*.la
}
